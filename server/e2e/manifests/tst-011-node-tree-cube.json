{
  "id": "tst_011_node_tree_cube",
  "description": "Create a cube and apply a simple Geometry Nodes graph, then verify scene outcomes.",
  "protocol": {
    "version": "1.0",
    "done": true,
    "final_message": "TST-011 manifest execution complete.",
    "steps": [
      {
        "id": "seed_cube",
        "type": "PYTHON",
        "description": "Ensure target cube exists",
        "payload": {
          "mode": "safe",
          "code": "target_name = 'TST011_Cube'\nobj = bpy.data.objects.get(target_name)\nif obj is None:\n    bpy.ops.mesh.primitive_cube_add(size=2.0)\n    bpy.context.active_object.name = target_name"
        }
      },
      {
        "id": "build_geo_nodes",
        "type": "NODE_TREE",
        "description": "Create a deterministic node graph",
        "payload": {
          "target": {
            "object_name": "TST011_Cube",
            "modifier_name": "GeometryNodes",
            "node_group_name": "TST011_NodeTree"
          },
          "operations": [
            {
              "op": "create_node",
              "node_id": "subdiv",
              "bl_idname": "GeometryNodeSubdivisionSurface",
              "location": [
                0,
                0
              ]
            },
            {
              "op": "set_input_default",
              "node_id": "subdiv",
              "socket": "Level",
              "value": 2
            },
            {
              "op": "link",
              "from": {
                "node_id": "group_input",
                "socket": "Geometry"
              },
              "to": {
                "node_id": "subdiv",
                "socket": "Mesh"
              }
            },
            {
              "op": "link",
              "from": {
                "node_id": "subdiv",
                "socket": "Mesh"
              },
              "to": {
                "node_id": "group_output",
                "socket": "Geometry"
              }
            }
          ]
        }
      }
    ]
  },
  "assertions": {
    "events": {
      "requireEventTypes": [
        "protocol_python",
        "protocol_node_tree"
      ]
    },
    "scene": {
      "objects": [
        {
          "objectName": "TST011_Cube",
          "modifierTypes": [
            "NODES"
          ],
          "nodeTypes": [
            "NodeGroupInput",
            "NodeGroupOutput",
            "GeometryNodeSubdivisionSurface"
          ]
        }
      ]
    }
  },
  "options": {
    "requireActiveRpcSession": true,
    "timeoutMs": 120000
  }
}
